{"version":"1.7.0","metadata":{"app":"scanner/ruby-fixture","language":{"name":"ruby","engine":"ruby","version":"3.0.1"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.83.4"},"git":{"repository":"git@github.com:applandinc/appmap-js.git","branch":"feat/hard-coded-password","commit":"f1111d3402ff3725ccc6545aa963fb7653ae624b","status":["M ../../../../doc/labels/crypto.encrypt.md","M ../../../../src/sampleConfig/default.yml","M Gemfile","M Gemfile.lock","M lib/crypt/command.rb","M test/crypt_test.rb","M tmp/appmap/minitest/Crypt_crypt_aes_128_cbc.appmap.json","M tmp/appmap/minitest/Crypt_crypt_aes_256_gcm.appmap.json","?? ../../../../../cli/src/cmds/sequenceDiagram/","?? ../../../../doc/labels/crypto.decrypt.md","?? ../../../../doc/labels/crypto.set_key.md","?? ../../../../doc/labels/string.unpack.md","?? ../../../../doc/rules/hard-coded-key.md","?? ../../../../src/rules/hard-coded-key/","?? ../../../scanner/hardCodedKey.spec.ts"],"git_last_annotated_tag":"@appland/appmap-v2.3.4","git_last_tag":"@appland/scanner-v1.63.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"Crypt crypt aes 256 gcm","source_location":"test/crypt_test.rb:11","frameworks":[{"name":"minitest","version":"5.16.2"}],"recorder":{"name":"minitest"},"test_status":"succeeded"},"classMap":[{"name":"lib/crypt","type":"package","children":[{"name":"Crypt","type":"class","children":[{"name":"Command","type":"class","children":[{"name":"encrypt_aes_256_gcm","type":"function","location":"lib/crypt/command.rb:15","static":true,"labels":["command"],"comment":"# @label command\n"}]}]}]},{"name":"openssl","type":"package","children":[{"name":"OpenSSL","type":"class","children":[{"name":"Cipher","type":"class","children":[{"name":"encrypt","type":"function","location":"OpenSSL::Cipher#encrypt","static":false,"labels":["crypto.encrypt"]},{"name":"random_key","type":"function","location":"/Users/kgilpin/.rbenv/versions/3.0.1/lib/ruby/3.0.0/openssl/cipher.rb:43","static":false,"comment":"# call-seq:\n#   cipher.random_key -> key\n#\n# Generate a random key with OpenSSL::Random.random_bytes and sets it to\n# the cipher, and returns it.\n#\n# You must call #encrypt or #decrypt before calling this method.\n"},{"name":"key=","type":"function","location":"OpenSSL::Cipher#key=","static":false,"labels":["crypto.set_key"]},{"name":"random_iv","type":"function","location":"/Users/kgilpin/.rbenv/versions/3.0.1/lib/ruby/3.0.0/openssl/cipher.rb:55","static":false,"comment":"# call-seq:\n#   cipher.random_iv -> iv\n#\n# Generate a random IV with OpenSSL::Random.random_bytes and sets it to the\n# cipher, and returns it.\n#\n# You must call #encrypt or #decrypt before calling this method.\n"},{"name":"iv=","type":"function","location":"OpenSSL::Cipher#iv=","static":false,"labels":["crypto.set_iv"]},{"name":"auth_data=","type":"function","location":"OpenSSL::Cipher#auth_data=","static":false,"labels":["crypto.set_auth_data"]},{"name":"update","type":"function","location":"OpenSSL::Cipher#update","static":false},{"name":"final","type":"function","location":"OpenSSL::Cipher#final","static":false,"labels":["crypto.final"]}]},{"name":"Random","type":"class","children":[{"name":"random_bytes","type":"function","location":"OpenSSL::Random.random_bytes","static":true,"labels":["random.secure"]}]}]}]}],"events":[{"id":41,"event":"call","thread_id":2400,"defined_class":"Crypt::Command","method_id":"encrypt_aes_256_gcm","path":"lib/crypt/command.rb","lineno":15,"static":true,"parameters":[{"name":"record_id","class":"String","object_id":2840,"value":"test_crypt_aes_256_gcm","kind":"req"},{"name":"key","class":"NilClass","object_id":8,"value":null,"kind":"key"}],"receiver":{"class":"Class","object_id":2460,"value":"Crypt::Command"}},{"id":42,"event":"call","thread_id":2400,"defined_class":"OpenSSL::Cipher","method_id":"encrypt","path":"OpenSSL::Cipher#encrypt","static":false,"parameters":[{"name":"arg","class":"Array","object_id":2860,"value":"[]","kind":"rest","size":0}],"receiver":{"class":"OpenSSL::Cipher","object_id":2880,"value":"#<OpenSSL::Cipher:0x00007fb630225298>","labels":["crypto.algorithm.id-aes256-GCM"]}},{"id":43,"event":"return","thread_id":2400,"parent_id":42,"elapsed":2.00001522898674e-06,"return_value":{"class":"OpenSSL::Cipher","value":"#<OpenSSL::Cipher:0x00007fb630225298>","object_id":2880}},{"id":44,"event":"call","thread_id":2400,"defined_class":"OpenSSL::Cipher","method_id":"random_key","path":"/Users/kgilpin/.rbenv/versions/3.0.1/lib/ruby/3.0.0/openssl/cipher.rb","lineno":43,"static":false,"parameters":[],"receiver":{"class":"OpenSSL::Cipher","object_id":2880,"value":"#<OpenSSL::Cipher:0x00007fb630225298>"}},{"id":45,"event":"call","thread_id":2400,"defined_class":"OpenSSL::Random","method_id":"random_bytes","path":"OpenSSL::Random.random_bytes","static":true,"parameters":[{"name":"arg","class":"Integer","object_id":65,"value":"32","kind":"req"}],"receiver":{"class":"Module","object_id":2520,"value":"OpenSSL::Random"}},{"id":46,"event":"return","thread_id":2400,"parent_id":45,"elapsed":6.00004568696022e-06,"return_value":{"class":"String","value":"c_la\f._.\u0005_\u001b___Qf\u0017b__\u000f__<thjJ{___","object_id":2900}},{"id":47,"event":"call","thread_id":2400,"defined_class":"OpenSSL::Cipher","method_id":"key=","path":"OpenSSL::Cipher#key=","static":false,"parameters":[{"name":"arg","class":"String","object_id":2900,"value":"c_la\f._.\u0005_\u001b___Qf\u0017b__\u000f__<thjJ{___","kind":"req"}],"receiver":{"class":"OpenSSL::Cipher","object_id":2880,"value":"#<OpenSSL::Cipher:0x00007fb630225298>"}},{"id":48,"event":"return","thread_id":2400,"parent_id":47,"elapsed":2.00001522898674e-06,"return_value":{"class":"String","value":"c_la\f._.\u0005_\u001b___Qf\u0017b__\u000f__<thjJ{___","object_id":2900}},{"id":49,"event":"return","thread_id":2400,"parent_id":44,"elapsed":7.599988020956516e-05,"return_value":{"class":"String","value":"c_la\f._.\u0005_\u001b___Qf\u0017b__\u000f__<thjJ{___","object_id":2900}},{"id":50,"event":"call","thread_id":2400,"defined_class":"OpenSSL::Cipher","method_id":"random_iv","path":"/Users/kgilpin/.rbenv/versions/3.0.1/lib/ruby/3.0.0/openssl/cipher.rb","lineno":55,"static":false,"parameters":[],"receiver":{"class":"OpenSSL::Cipher","object_id":2880,"value":"#<OpenSSL::Cipher:0x00007fb630225298>"}},{"id":51,"event":"call","thread_id":2400,"defined_class":"OpenSSL::Random","method_id":"random_bytes","path":"OpenSSL::Random.random_bytes","static":true,"parameters":[{"name":"arg","class":"Integer","object_id":25,"value":"12","kind":"req"}],"receiver":{"class":"Module","object_id":2520,"value":"OpenSSL::Random"}},{"id":52,"event":"return","thread_id":2400,"parent_id":51,"elapsed":3.00002284348011e-06,"return_value":{"class":"String","value":"__\b__'W__7_\u000b","object_id":2920}},{"id":53,"event":"call","thread_id":2400,"defined_class":"OpenSSL::Cipher","method_id":"iv=","path":"OpenSSL::Cipher#iv=","static":false,"parameters":[{"name":"arg","class":"String","object_id":2920,"value":"__\b__'W__7_\u000b","kind":"req"}],"receiver":{"class":"OpenSSL::Cipher","object_id":2880,"value":"#<OpenSSL::Cipher:0x00007fb630225298>"}},{"id":54,"event":"return","thread_id":2400,"parent_id":53,"elapsed":1.00000761449337e-06,"return_value":{"class":"String","value":"__\b__'W__7_\u000b","object_id":2920}},{"id":55,"event":"return","thread_id":2400,"parent_id":50,"elapsed":6.3000014051795e-05,"return_value":{"class":"String","value":"__\b__'W__7_\u000b","object_id":2920}},{"id":56,"event":"call","thread_id":2400,"defined_class":"OpenSSL::Cipher","method_id":"auth_data=","path":"OpenSSL::Cipher#auth_data=","static":false,"parameters":[{"name":"arg","class":"String","object_id":2840,"value":"test_crypt_aes_256_gcm","kind":"req"}],"receiver":{"class":"OpenSSL::Cipher","object_id":2880,"value":"#<OpenSSL::Cipher:0x00007fb630225298>"}},{"id":57,"event":"return","thread_id":2400,"parent_id":56,"elapsed":2.00001522898674e-06,"return_value":{"class":"String","value":"test_crypt_aes_256_gcm","object_id":2840}},{"id":58,"event":"call","thread_id":2400,"defined_class":"OpenSSL::Cipher","method_id":"update","path":"OpenSSL::Cipher#update","static":false,"parameters":[{"name":"arg","class":"Array","object_id":2940,"value":"[Very, very confidential data]","kind":"rest","size":1}],"receiver":{"class":"OpenSSL::Cipher","object_id":2880,"value":"#<OpenSSL::Cipher:0x00007fb630225298>"}},{"id":59,"event":"return","thread_id":2400,"parent_id":58,"elapsed":2.00001522898674e-06,"return_value":{"class":"String","value":"\bnP\u001f__ SezK\u0012\f\u001e\r__jD_\u0015__UD\u001a+_","object_id":2960}},{"id":60,"event":"call","thread_id":2400,"defined_class":"OpenSSL::Cipher","method_id":"final","path":"OpenSSL::Cipher#final","static":false,"parameters":[],"receiver":{"class":"OpenSSL::Cipher","object_id":2880,"value":"#<OpenSSL::Cipher:0x00007fb630225298>"}},{"id":61,"event":"return","thread_id":2400,"parent_id":60,"elapsed":2.00001522898674e-06,"return_value":{"class":"String","value":"","object_id":2980}},{"id":62,"event":"return","thread_id":2400,"parent_id":41,"elapsed":0.00036300020292401314,"return_value":{"class":"String","value":"\bnP\u001f__ SezK\u0012\f\u001e\r__jD_\u0015__UD\u001a+_","object_id":3000}}]}