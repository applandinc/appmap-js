{"version":"1.7.0","metadata":{"app":"scanner/ruby-fixture","language":{"name":"ruby","engine":"ruby","version":"3.0.1"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.83.6"},"git":{"repository":"git@github.com:applandinc/appmap-js.git","branch":"feat/eval-of-untrusted-code","commit":"a5cfeb6db0bc08dd443e46a734c6b55b53ee21b4","status":["M ../../../../doc/rules/secret-in-log.md","M ../../../../doc/rules/slow-function-call.md","M ../../../../doc/rules/unauthenticated-encryption.md","M tmp/appmap/minitest/Eval_eval_safe.appmap.json","M tmp/appmap/minitest/Eval_eval_sanitized.appmap.json","M tmp/appmap/minitest/Eval_eval_unsafe.appmap.json"],"git_last_annotated_tag":"@appland/appmap-v2.3.4","git_last_tag":"@appland/appmap-v3.32.1","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"Eval eval sanitized","source_location":"test/eval_test.rb:13","frameworks":[{"name":"minitest","version":"5.16.2"}],"recorder":{"name":"minitest"},"test_status":"succeeded"},"classMap":[{"name":"lib/eval","type":"package","children":[{"name":"Eval","type":"class","children":[{"name":"Command","type":"class","children":[{"name":"sanitize_eval_code","type":"function","location":"lib/eval/command.rb:16","static":true,"labels":["command"],"comment":"# @label command\n"},{"name":"sanitize","type":"function","location":"lib/eval/command.rb:21","static":true,"labels":["lang.eval.sanitize"],"comment":"# @label lang.eval.sanitize\n"}]}]}]},{"name":"ruby","type":"package","children":[{"name":"Kernel","type":"class","children":[{"name":"eval","type":"function","location":"Kernel.eval","static":true,"labels":["lang.eval"]}]}]}],"events":[{"id":5,"event":"call","thread_id":2380,"defined_class":"Eval::Command","method_id":"sanitize_eval_code","path":"lib/eval/command.rb","lineno":16,"static":true,"parameters":[{"name":"code_str","class":"String","object_id":2440,"value":"puts 'Hello, I am safe!'","kind":"req"}],"receiver":{"class":"Class","object_id":2360,"value":"Eval::Command"}},{"id":6,"event":"call","thread_id":2380,"defined_class":"Eval::Command","method_id":"sanitize","path":"lib/eval/command.rb","lineno":21,"static":true,"parameters":[{"name":"code_str","class":"String","object_id":2440,"value":"puts 'Hello, I am safe!'","kind":"req"}],"receiver":{"class":"Class","object_id":2360,"value":"Eval::Command"}},{"id":7,"event":"return","thread_id":2380,"parent_id":6,"elapsed":7.00005330145359e-06,"return_value":{"class":"String","value":"puts 'Hello, I am safe!'","object_id":2440}},{"id":8,"event":"call","thread_id":2380,"defined_class":"Kernel","method_id":"eval","path":"Kernel.eval","static":true,"parameters":[{"name":"string","class":"String","object_id":2440,"value":"puts 'Hello, I am safe!'","kind":"req"},{"name":"binding","class":"NilClass","object_id":8,"value":null,"kind":"opt"},{"name":"filename","class":"NilClass","object_id":8,"value":null,"kind":"opt"},{"name":"lineno","class":"NilClass","object_id":8,"value":null,"kind":"opt"}],"receiver":{"class":"Class","object_id":2360,"value":"Eval::Command"}},{"id":9,"event":"return","thread_id":2380,"parent_id":8,"elapsed":0.00010200007818639278},{"id":10,"event":"return","thread_id":2380,"parent_id":5,"elapsed":0.00025100004859268665}]}