{"version":"1.7.0","metadata":{"app":"scanner/ruby-fixture","language":{"name":"ruby","engine":"ruby","version":"3.0.1"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.83.4"},"git":{"repository":"git@github.com:applandinc/appmap-js.git","branch":"feat/hard-coded-password","commit":"f1111d3402ff3725ccc6545aa963fb7653ae624b","status":["M ../../../../doc/labels/crypto.encrypt.md","M ../../../../src/sampleConfig/default.yml","M Gemfile","M Gemfile.lock","M lib/crypt/command.rb","M test/crypt_test.rb","M tmp/appmap/minitest/Crypt_crypt_aes_128_cbc.appmap.json","M tmp/appmap/minitest/Crypt_crypt_aes_256_gcm.appmap.json","?? ../../../../../cli/src/cmds/sequenceDiagram/","?? ../../../../doc/labels/crypto.decrypt.md","?? ../../../../doc/labels/crypto.set_key.md","?? ../../../../doc/labels/string.unpack.md","?? ../../../../doc/rules/hard-coded-key.md","?? ../../../../src/rules/hard-coded-key/","?? ../../../scanner/hardCodedKey.spec.ts"],"git_last_annotated_tag":"@appland/appmap-v2.3.4","git_last_tag":"@appland/scanner-v1.63.0","git_commits_since_last_annotated_tag":0,"git_commits_since_last_tag":0},"name":"Crypt crypt aes 128 cbc","source_location":"test/crypt_test.rb:6","frameworks":[{"name":"minitest","version":"5.16.2"}],"recorder":{"name":"minitest"},"test_status":"succeeded"},"classMap":[{"name":"lib/crypt","type":"package","children":[{"name":"Crypt","type":"class","children":[{"name":"Command","type":"class","children":[{"name":"encrypt_aes_128_cbc","type":"function","location":"lib/crypt/command.rb:4","static":true,"labels":["command"],"comment":"# @label command\n"}]}]}]},{"name":"openssl","type":"package","children":[{"name":"OpenSSL","type":"class","children":[{"name":"Cipher","type":"class","children":[{"name":"encrypt","type":"function","location":"OpenSSL::Cipher#encrypt","static":false,"labels":["crypto.encrypt"]},{"name":"random_key","type":"function","location":"/Users/kgilpin/.rbenv/versions/3.0.1/lib/ruby/3.0.0/openssl/cipher.rb:43","static":false,"comment":"# call-seq:\n#   cipher.random_key -> key\n#\n# Generate a random key with OpenSSL::Random.random_bytes and sets it to\n# the cipher, and returns it.\n#\n# You must call #encrypt or #decrypt before calling this method.\n"},{"name":"key=","type":"function","location":"OpenSSL::Cipher#key=","static":false,"labels":["crypto.set_key"]},{"name":"random_iv","type":"function","location":"/Users/kgilpin/.rbenv/versions/3.0.1/lib/ruby/3.0.0/openssl/cipher.rb:55","static":false,"comment":"# call-seq:\n#   cipher.random_iv -> iv\n#\n# Generate a random IV with OpenSSL::Random.random_bytes and sets it to the\n# cipher, and returns it.\n#\n# You must call #encrypt or #decrypt before calling this method.\n"},{"name":"iv=","type":"function","location":"OpenSSL::Cipher#iv=","static":false,"labels":["crypto.set_iv"]},{"name":"update","type":"function","location":"OpenSSL::Cipher#update","static":false},{"name":"final","type":"function","location":"OpenSSL::Cipher#final","static":false,"labels":["crypto.final"]}]},{"name":"Random","type":"class","children":[{"name":"random_bytes","type":"function","location":"OpenSSL::Random.random_bytes","static":true,"labels":["random.secure"]}]}]}]}],"events":[{"id":21,"event":"call","thread_id":2400,"defined_class":"Crypt::Command","method_id":"encrypt_aes_128_cbc","path":"lib/crypt/command.rb","lineno":4,"static":true,"parameters":[],"receiver":{"class":"Class","object_id":2460,"value":"Crypt::Command"}},{"id":22,"event":"call","thread_id":2400,"defined_class":"OpenSSL::Cipher","method_id":"encrypt","path":"OpenSSL::Cipher#encrypt","static":false,"parameters":[{"name":"arg","class":"Array","object_id":2660,"value":"[]","kind":"rest","size":0}],"receiver":{"class":"OpenSSL::Cipher","object_id":2680,"value":"#<OpenSSL::Cipher:0x00007fb63025ea70>","labels":["crypto.algorithm.AES-128-CBC"]}},{"id":23,"event":"return","thread_id":2400,"parent_id":22,"elapsed":4.00003045797348e-06,"return_value":{"class":"OpenSSL::Cipher","value":"#<OpenSSL::Cipher:0x00007fb63025ea70>","object_id":2680}},{"id":24,"event":"call","thread_id":2400,"defined_class":"OpenSSL::Cipher","method_id":"random_key","path":"/Users/kgilpin/.rbenv/versions/3.0.1/lib/ruby/3.0.0/openssl/cipher.rb","lineno":43,"static":false,"parameters":[],"receiver":{"class":"OpenSSL::Cipher","object_id":2680,"value":"#<OpenSSL::Cipher:0x00007fb63025ea70>"}},{"id":25,"event":"call","thread_id":2400,"defined_class":"OpenSSL::Random","method_id":"random_bytes","path":"OpenSSL::Random.random_bytes","static":true,"parameters":[{"name":"arg","class":"Integer","object_id":33,"value":"16","kind":"req"}],"receiver":{"class":"Module","object_id":2520,"value":"OpenSSL::Random"}},{"id":26,"event":"return","thread_id":2400,"parent_id":25,"elapsed":2.400018274784088e-05,"return_value":{"class":"String","value":"_(__h_?5__{____#","object_id":2700}},{"id":27,"event":"call","thread_id":2400,"defined_class":"OpenSSL::Cipher","method_id":"key=","path":"OpenSSL::Cipher#key=","static":false,"parameters":[{"name":"arg","class":"String","object_id":2700,"value":"_(__h_?5__{____#","kind":"req"}],"receiver":{"class":"OpenSSL::Cipher","object_id":2680,"value":"#<OpenSSL::Cipher:0x00007fb63025ea70>"}},{"id":28,"event":"return","thread_id":2400,"parent_id":27,"elapsed":2.00001522898674e-06,"return_value":{"class":"String","value":"_(__h_?5__{____#","object_id":2700}},{"id":29,"event":"return","thread_id":2400,"parent_id":24,"elapsed":0.00012199999764561653,"return_value":{"class":"String","value":"_(__h_?5__{____#","object_id":2700}},{"id":30,"event":"call","thread_id":2400,"defined_class":"OpenSSL::Cipher","method_id":"random_iv","path":"/Users/kgilpin/.rbenv/versions/3.0.1/lib/ruby/3.0.0/openssl/cipher.rb","lineno":55,"static":false,"parameters":[],"receiver":{"class":"OpenSSL::Cipher","object_id":2680,"value":"#<OpenSSL::Cipher:0x00007fb63025ea70>"}},{"id":31,"event":"call","thread_id":2400,"defined_class":"OpenSSL::Random","method_id":"random_bytes","path":"OpenSSL::Random.random_bytes","static":true,"parameters":[{"name":"arg","class":"Integer","object_id":33,"value":"16","kind":"req"}],"receiver":{"class":"Module","object_id":2520,"value":"OpenSSL::Random"}},{"id":32,"event":"return","thread_id":2400,"parent_id":31,"elapsed":2.9997900128364563e-06,"return_value":{"class":"String","value":"__i_~_#__{X_\u0007\"__","object_id":2720}},{"id":33,"event":"call","thread_id":2400,"defined_class":"OpenSSL::Cipher","method_id":"iv=","path":"OpenSSL::Cipher#iv=","static":false,"parameters":[{"name":"arg","class":"String","object_id":2720,"value":"__i_~_#__{X_\u0007\"__","kind":"req"}],"receiver":{"class":"OpenSSL::Cipher","object_id":2680,"value":"#<OpenSSL::Cipher:0x00007fb63025ea70>"}},{"id":34,"event":"return","thread_id":2400,"parent_id":33,"elapsed":2.00001522898674e-06,"return_value":{"class":"String","value":"__i_~_#__{X_\u0007\"__","object_id":2720}},{"id":35,"event":"return","thread_id":2400,"parent_id":30,"elapsed":8.299993351101875e-05,"return_value":{"class":"String","value":"__i_~_#__{X_\u0007\"__","object_id":2720}},{"id":36,"event":"call","thread_id":2400,"defined_class":"OpenSSL::Cipher","method_id":"update","path":"OpenSSL::Cipher#update","static":false,"parameters":[{"name":"arg","class":"Array","object_id":2740,"value":"[Very, very confidential data]","kind":"rest","size":1}],"receiver":{"class":"OpenSSL::Cipher","object_id":2680,"value":"#<OpenSSL::Cipher:0x00007fb63025ea70>"}},{"id":37,"event":"return","thread_id":2400,"parent_id":36,"elapsed":6.9998204708099365e-06,"return_value":{"class":"String","value":"_\u0013_\u00117____6\u0006#_(|_","object_id":2760}},{"id":38,"event":"call","thread_id":2400,"defined_class":"OpenSSL::Cipher","method_id":"final","path":"OpenSSL::Cipher#final","static":false,"parameters":[],"receiver":{"class":"OpenSSL::Cipher","object_id":2680,"value":"#<OpenSSL::Cipher:0x00007fb63025ea70>"}},{"id":39,"event":"return","thread_id":2400,"parent_id":38,"elapsed":9.999843314290047e-06,"return_value":{"class":"String","value":"_L___\u0002__r[__3_\u0019_","object_id":2780}},{"id":40,"event":"return","thread_id":2400,"parent_id":21,"elapsed":0.0005129999481141567,"return_value":{"class":"String","value":"_\u0013_\u00117____6\u0006#_(|__L___\u0002__r[__3_\u0019_","object_id":2800}}]}